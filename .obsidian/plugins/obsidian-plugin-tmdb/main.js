/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var u=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var w=Object.prototype.hasOwnProperty;var S=(r,o)=>{for(var e in o)u(r,e,{get:o[e],enumerable:!0})},F=(r,o,e,t)=>{if(o&&typeof o=="object"||typeof o=="function")for(let s of E(o))!w.call(r,s)&&s!==e&&u(r,s,{get:()=>o[s],enumerable:!(t=f(o,s))||t.enumerable});return r};var _=r=>F(u({},"__esModule",{value:!0}),r);var P={};S(P,{default:()=>g});module.exports=_(P);var i=require("obsidian"),x={tmdbApiKey:"",tmdbLanguage:"pt-BR",notesFolderFilmes:"",notesFolderSeries:""},g=class extends i.Plugin{async onload(){await this.loadSettings(),this.addRibbonIcon("film","TMDB Plugin",t=>{new i.Notice("Buscando filmes..."),this.openSearchModal()}).addClass("tmdb-plugin-ribbon-class"),this.addCommand({id:"search-movie",name:"Buscar Filme na TMDB",callback:()=>{this.openSearchModal()}}),this.addSettingTab(new m(this.app,this))}openSearchModal(){new h(this.app,this).open()}async loadSettings(){this.settings=Object.assign({},x,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}},h=class extends i.Modal{constructor(e,t){super(e);this.plugin=t}onOpen(){let{contentEl:e}=this;e.createEl("h1",{text:"Buscar Filme ou S\xE9rie"});let t=e.createEl("div");t.style.display="flex",t.style.flexDirection="column",t.style.gap="10px";let s=t.createEl("input",{type:"text",placeholder:"Digite o nome do filme ou s\xE9rie..."}),a=t.createEl("select");a.createEl("option",{text:"Filme",value:"movie"}),a.createEl("option",{text:"S\xE9rie",value:"tv"});let n=t.createEl("button",{text:"Buscar"});e.appendChild(t);let d=async()=>{let c=s.value.trim(),l=a.value;c?await this.searchMovieOrSeries(c,l):new i.Notice("Por favor, insira um nome.")};n.onclick=d,s.addEventListener("keypress",c=>{c.key==="Enter"&&d()})}async searchMovieOrSeries(e,t){let s=`https://api.themoviedb.org/3/search/${t}?api_key=${this.plugin.settings.tmdbApiKey}&query=${encodeURIComponent(e)}&language=${this.plugin.settings.tmdbLanguage}`;try{let n=await(await fetch(s)).json();n.results&&n.results.length>0?this.displayResults(n.results,t):new i.Notice("Nenhum resultado encontrado.")}catch(a){console.error(a),new i.Notice("Erro ao buscar dados.")}}displayResults(e,t){let{contentEl:s}=this;s.empty(),s.createEl("h2",{text:"Resultados da Busca"}),e.forEach(a=>{let n=s.createEl("div",{cls:"item-result"}),d=a.poster_path?`https://image.tmdb.org/t/p/w500${a.poster_path}`:"",c=n.createEl("img",{attr:{src:d,alt:a.title||a.name,width:"100px"}}),l=n.createEl("div"),v=a.title||a.name,y=l.createEl("span",{text:`${v.toUpperCase()} (${a.release_date||a.first_air_date?(a.release_date||a.first_air_date).split("-")[0]:"Desconhecido"})`});y.style.fontWeight="bold";let p=a.overview||"Nenhum resumo dispon\xEDvel.",b=p.length>200?`${p.substring(0,197)}...`:p,D=l.createEl("div",{text:`${b}`});n.onclick=()=>{this.createNoteForItem(a,t)},n.style.display="flex",n.style.alignItems="center",n.style.marginBottom="10px",c.style.marginRight="10px"})}async createNoteForItem(e,t){let a=`${(l=>l.replace(/[\/:*?"<>|]/g,""))(e.title||e.name)} (${t==="movie"?e.release_date?e.release_date.split("-")[0]:"Desconhecido":e.first_air_date?e.first_air_date.split("-")[0]:"Desconhecido"}).md`,n=`---
titulo: "${e.title||e.name}"
tipo: ${t==="movie"?"Filme":"S\xE9rie"}
ano: "${t==="movie"?e.release_date?e.release_date.split("-")[0]:"Desconhecido":e.first_air_date?e.first_air_date.split("-")[0]:"Desconhecido"}"
g\xEAnero:
  - ${e.genre_ids.map(l=>this.getGenreName(l)).join(`
  - `)}
image: https://image.tmdb.org/t/p/w500${e.poster_path}
lan\xE7ado: ${t==="movie"?e.release_date:e.first_air_date}
assistido: false
nota:
tags:
  - ${t==="movie"?"filme":"s\xE9rie"}
---
# Resumo
${e.overview||"Nenhuma descri\xE7\xE3o dispon\xEDvel."}
`,d=t==="movie"?this.plugin.settings.notesFolderFilmes:this.plugin.settings.notesFolderSeries,c=d?`${d}/${a}`:a;try{await this.app.vault.create(c,n),new i.Notice(`Nota criada: ${c}`),this.close()}catch(l){new i.Notice("Erro ao criar a nota. Verifique se a pasta existe."),console.error(l)}}getGenreName(e){return{28:"A\xE7\xE3o",12:"Aventura",16:"Anima\xE7\xE3o",35:"Com\xE9dia",80:"Crime",99:"Document\xE1rio",18:"Drama",27:"Terror",10402:"M\xFAsica",9648:"Mist\xE9rio",10749:"Romance",878:"Fic\xE7\xE3o Cient\xEDfica",10770:"Filmes de TV",53:"Thriller",10752:"Guerra",37:"Faroeste"}[e]||"Desconhecido"}onClose(){let{contentEl:e}=this;e.empty()}},m=class extends i.PluginSettingTab{constructor(e,t){super(e,t);this.plugin=t}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"Configura\xE7\xF5es do TMDB Plugin"}),new i.Setting(e).setName("API Key").setDesc("Insira sua chave da API do TMDB.").addText(t=>t.setPlaceholder("Insira a chave da API").setValue(this.plugin.settings.tmdbApiKey).onChange(async s=>{this.plugin.settings.tmdbApiKey=s,await this.plugin.saveSettings()})),new i.Setting(e).setName("Idioma").setDesc("Selecione o idioma padr\xE3o para as buscas.").addDropdown(t=>t.addOption("pt-BR","Portugu\xEAs Brasileiro").addOption("en-US","Ingl\xEAs (Estados Unidos)").onChange(async s=>{this.plugin.settings.tmdbLanguage=s,await this.plugin.saveSettings()})),new i.Setting(e).setName("Pasta para Notas de Filmes").setDesc("Caminho da pasta onde as notas de filmes ser\xE3o criadas.").addText(t=>t.setPlaceholder("Pasta para Notas de Filmes").setValue(this.plugin.settings.notesFolderFilmes).onChange(async s=>{this.plugin.settings.notesFolderFilmes=s,await this.plugin.saveSettings()})),new i.Setting(e).setName("Pasta para Notas de S\xE9ries").setDesc("Caminho da pasta onde as notas de s\xE9ries ser\xE3o criadas.").addText(t=>t.setPlaceholder("Pasta para Notas de S\xE9ries").setValue(this.plugin.settings.notesFolderSeries).onChange(async s=>{this.plugin.settings.notesFolderSeries=s,await this.plugin.saveSettings()}))}};
